package com.zptioning.code.chapter08;import java.util.concurrent.ExecutorService;import java.util.concurrent.Executors;import java.util.concurrent.Semaphore;import java.util.concurrent.TimeUnit;/** * @author tengfei.fangtf * @version $Id: SemaphoreTest.java, v 0.1 2015-8-1 ����12:10:19 tengfei.fangtf Exp $ * * 虽然有30个线程在执行，但是只允许最多10个并发执行 */public class SemaphoreTest {    private static final int THREAD_COUNT = 30;    private static ExecutorService threadPool = Executors.newFixedThreadPool(THREAD_COUNT);    private static Semaphore s = new Semaphore(10);    public static void main(String[] args) {        for (int i = 0; i < THREAD_COUNT; i++) {            threadPool.execute(new Runnable() {                @Override                public void run() {                    try {                        String name = Thread.currentThread().getName();                        System.out.println(name + "：before acquire!!!");                        s.acquire();                        TimeUnit.SECONDS.sleep(1);                        System.out.println(name + "：save data");                        TimeUnit.SECONDS.sleep(1);                        s.release();                        System.out.println(name + "：after release!!!");                    } catch (InterruptedException e) {                    }                }            });        }        threadPool.shutdown();    }}/*pool-1-thread-1：before acquire!!!pool-1-thread-4：before acquire!!!pool-1-thread-2：before acquire!!!pool-1-thread-3：before acquire!!!pool-1-thread-5：before acquire!!!pool-1-thread-6：before acquire!!!pool-1-thread-7：before acquire!!!pool-1-thread-8：before acquire!!!pool-1-thread-9：before acquire!!!pool-1-thread-10：before acquire!!!pool-1-thread-11：before acquire!!!pool-1-thread-12：before acquire!!!pool-1-thread-13：before acquire!!!pool-1-thread-14：before acquire!!!pool-1-thread-15：before acquire!!!pool-1-thread-16：before acquire!!!pool-1-thread-17：before acquire!!!pool-1-thread-18：before acquire!!!pool-1-thread-19：before acquire!!!pool-1-thread-20：before acquire!!!pool-1-thread-21：before acquire!!!pool-1-thread-22：before acquire!!!pool-1-thread-23：before acquire!!!pool-1-thread-24：before acquire!!!pool-1-thread-25：before acquire!!!pool-1-thread-26：before acquire!!!pool-1-thread-27：before acquire!!!pool-1-thread-28：before acquire!!!pool-1-thread-29：before acquire!!!pool-1-thread-30：before acquire!!!pool-1-thread-1：save datapool-1-thread-4：save datapool-1-thread-3：save datapool-1-thread-2：save datapool-1-thread-5：save datapool-1-thread-7：save datapool-1-thread-6：save datapool-1-thread-8：save datapool-1-thread-9：save datapool-1-thread-10：save datapool-1-thread-1：after release!!!pool-1-thread-4：after release!!!pool-1-thread-2：after release!!!pool-1-thread-5：after release!!!pool-1-thread-3：after release!!!pool-1-thread-7：after release!!!pool-1-thread-6：after release!!!pool-1-thread-8：after release!!!pool-1-thread-9：after release!!!pool-1-thread-10：after release!!!pool-1-thread-12：save datapool-1-thread-11：save datapool-1-thread-13：save datapool-1-thread-14：save datapool-1-thread-15：save datapool-1-thread-16：save datapool-1-thread-17：save datapool-1-thread-19：save datapool-1-thread-18：save datapool-1-thread-20：save datapool-1-thread-11：after release!!!pool-1-thread-12：after release!!!pool-1-thread-14：after release!!!pool-1-thread-13：after release!!!pool-1-thread-15：after release!!!pool-1-thread-17：after release!!!pool-1-thread-18：after release!!!pool-1-thread-19：after release!!!pool-1-thread-16：after release!!!pool-1-thread-20：after release!!!pool-1-thread-21：save datapool-1-thread-22：save datapool-1-thread-23：save datapool-1-thread-24：save datapool-1-thread-26：save datapool-1-thread-27：save datapool-1-thread-29：save datapool-1-thread-28：save datapool-1-thread-25：save datapool-1-thread-30：save datapool-1-thread-22：after release!!!pool-1-thread-21：after release!!!pool-1-thread-24：after release!!!pool-1-thread-23：after release!!!pool-1-thread-29：after release!!!pool-1-thread-26：after release!!!pool-1-thread-27：after release!!!pool-1-thread-25：after release!!!pool-1-thread-28：after release!!!pool-1-thread-30：after release!!!* */